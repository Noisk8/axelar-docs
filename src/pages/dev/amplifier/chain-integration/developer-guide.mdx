# Chain Integration developer guide

import { Callout } from "/src/components/callout"

<Callout>
The Axelar Virtual Machine (AVM) and Amplifier are currently under active development, so these instructions are likely to change. Please check back frequently for updates.
</Callout>

## Integration architecture

To connect your chain to the Axelar network via the Interchain Amplifier, you'll need to build or instantiate a [message relayer](/dev/amplifier/chain-integration/introduction#message-relayer) service and the following four smart contracts:

- [Source chain gateway](/dev/amplifier/chain-integration/introduction#source-chain-gateway-contract)
- [Axelar gateway](/dev/amplifier/chain-integration/introduction#axelar-gateway-contract)
- [Voting verifier](/dev/amplifier/chain-integration/introduction#verifier-contract)
- [Multisig prover](/dev/amplifier/chain-integration/introduction#prover-contract)

### Message relayer

- This is a service built with any tech stack that listens for events on your chain and relays them to the Axelar network.
- For a detailed implementation, see the [Message Relayer example](https://github.com/axelarnetwork/axelar-examples/tree/main/examples/amplifier) on GitHub.

### Source chain gateway contract

- This is the gateway contract for your source chain, built using the same tech stack as that chain. It serves as the primary API for developers sending messages from your chain.
- The contract must implement the [Cross-Chain Gateway Protocol](https://github.com/axelarnetwork/cgp-spec).
- EVM chains can re-use the existing [EVM Gateway](https://github.com/axelarnetwork/axelar-cgp-solidity).

### Axelar gateway contract

- This is a smart contract on the Axelar network that checks the validity of a transaction with the verifier contract and forwards it to the Amplifier router.
- Most integrators will begin by using or customizing the Axelar [Gateway contract](https://github.com/axelarnetwork/axelar-amplifier/blob/main/doc/src/contracts/gateway.md).

### Voting verifier contract

- This is a smart contract on the Axelar network that verifies the validity of transactions on your chain.
- Most integrators will begin by using or customizing the Axelar [Voting Verifier contract](https://github.com/axelarnetwork/axelar-amplifier/blob/main/doc/src/contracts/voting_verifier.md), which can be customized to your needs for cases such as verification via ZK Proof.
- If you deploy a Voting Verifier contract, verifiers will need to support your chain and vote on the truth of source chain transactions.

### Multisig prover contract

- This is a smart contract on the Axelar network that knows how to prove the validity of a transaction on your chain.
- Most integrators will begin by using or customizing the Axelar [Multisig Prover contract](https://github.com/axelarnetwork/axelar-amplifier/blob/main/doc/src/contracts/multisig_prover.md).

The [chain integration tutorial](/dev/amplifier/chain-integration/integrate-a-chain) will guide you through this process on the current Amplifier devnet, which requires submitting a [chain integration form](https://docs.google.com/forms/d/e/1FAIpQLSchD7P1WfdSCQfaZAoqX7DyqJOqYKxXle47yrueTbOgkKQDiQ/viewform) to the Interop Labs team at the end. Contract deployment on testnet or mainnet will require a governance proposal.

## Integration process

Most integrators will do the following to onboard their chains onto the Axelar Amplifier:

**1. Learn and understand Amplifier**

Follow the [chain integration tutorial](/dev/amplifier/chain-integration/integrate-a-chain) and deploy standardized contracts onto the devnet to understand the tools and basics of the process.

**2. Customize and deploy to the Amplifier devnet**

Build (or instantiate or customize) your own version of the relayer and the [required contracts](/dev/amplifier/chain-integration/introduction#integration-architecture). For example, if you have a ZK use case, you may choose to change the logic of your verifier or prover contract.

**3. Whitelist contracts on the Amplifier devnet**

Fill out the [Amplifier Chain Integration Form](https://docs.google.com/forms/d/e/1FAIpQLSchD7P1WfdSCQfaZAoqX7DyqJOqYKxXle47yrueTbOgkKQDiQ/viewform) to whitelist your chain on the devnet.

**4. Become a verifier for your chain**

In order to properly test your integration, you will need [active verifiers](/validator/amplifier/verifier-onboarding) to vote on messages coming from your chain.

**5. Test your integration**

Make sure you can send and receive messages on your chain.

**6. Begin audit process**

Audit your on-chain contracts.

**7. Propose to testnet**

1. Make two on-chain proposals on the testnet to create your CosmWasm smart contracts:

    - A proposal to store your CosmWasm code
    - A proposal to instantiate your contracts

1. Make an on-chain proposal to add your chain to the Amplifier router. A router uses the governance method [`RegisterChain()`](https://github.com/axelarnetwork/axelar-amplifier/blob/main/packages/router-api/src/msg.rs#L13) to find and register new chain integrations. The chain name is then used to fund rewards and connect verifiers.

**8. Test in testnet**

Ensure your contracts are working as expected, and verify with developers that they can send messages to and from your chain.

**9. Productionize your relayer**

Ensure your relayer is robust, fault-tolerant, and can handle the load of your chain.

**10. Propose to mainnet**

1. Make two on-chain governance proposals on mainnet to create your CosmWasm smart contracts:
    - A proposal to store your CosmWasm code
    - A proposal to instantiate your contracts

1. Make an on-chain proposal to add your chain to the Amplifier router. A router uses the governance method [`RegisterChain()`](https://github.com/axelarnetwork/axelar-amplifier/blob/main/packages/router-api/src/msg.rs#L13) to find and register new chain integrations. The chain name is then used to fund rewards and connect verifiers.

## Manage the rewards pool

### Check status of a rewards pool

Use the following command to check the status of a rewards pool:

```bash
axelard tx wasm execute $CONTRACT_ADDRESS '' --from validator --gas auto --gas-adjustment 2
axelard q wasm contract-state smart [rewards contract address] '{"rewards_pool":{"pool_id":{"chain_name":[chain-name],"contract":[address of voting verifier or multisig]}}}' --node $RPC
```

When querying for voting rewards, `contract` is the address of the voting verifier.

### Add rewards to a pool

Use the following command to add voting rewards to a pool:

```bash
axelard tx wasm execute [rewards contract address] '{"add_rewards":{"pool_id":{"chain_name":[chain-name],"contract":[address of voting verifier or multisig]}}}' --amount [amount to add] --from [key] --gas auto --gas-adjustment 2
```