# Obtener una direcci贸n de dep贸sito

import { Callout } from "/src/components/callout"

Una direcci贸n de dep贸sito es una direcci贸n especial temporal creada y supervisada por **Axelar's Relayer Services** en nombre del solicitante. Es similar a la forma en que las bolsas centralizadas generan una direcci贸n de dep贸sito 煤nica y supervisada que facilita las transferencias de tokens. Las direcciones de dep贸sito suelen funcionar durante un m谩ximo de 24 horas.

### Flujo de trabajo de la direcci贸n de dep贸sito

1. El usuario genera una direcci贸n de dep贸sito en una cadena de origen espec铆fica.
2. 2. El usuario env铆a tokens a la direcci贸n de dep贸sito de la cadena de origen.

- Ejemplos:

  - retirada de un exchange centralizado
  - transacci贸n desde su wallet favorito.

<Callout emoji="癸">
 NOTA IMPORTANTE: Al realizar su deposito, aseg煤rese de que el importe es     **mayor que la tasa de gas fee del relay cross-chain**
- Aqu铆 encontrar谩 una tabla de tasas:
[mainnet](../../resources/mainnet#cross-chain-relayer-gas-fee) | [testnet](../../resources/testnet#cross-chain-relayer-gas-fee).
- Tambi茅n se pueden consultar mediante programaci贸n en el SDK [AxelarQueryAPI](../axelarjs-sdk/axelar-query-api#gettransferfee).
</Callout>

3. Los relays de Axelar observan la transacci贸n de dep贸sito en la cadena de origen y la completan en la cadena de destino, suponiendo que el importe supere la tasa requerida..
4. Observa c贸mo llegan tus tokens a la cadena de destino.

### 1. Prerequisite

Para ayudarte a escribir c贸digo limpio, puedes utilizar las constantes `Environment` y `CHAINS`.

La mayor铆a de los m茅todos en el sdk requieren que trabajes con identificadores de cadena en lugar de nombres de cadena. **Los identificadores de cadena son 煤nicos por entorno** y son _espec铆ficos de Axelar_. Por ejemplo, Ethereum tendr谩 un id de cadena `ethereum` en mainnet pero `ethereum-2` en testnet. Del mismo modo, Osmosis ser谩 `osmosis` en mainnet pero `osmosis-4` en tesnet. Sin embargo, algunas cadenas no tendr谩n ninguna diferencia entre los nombres de cadena y los identificadores de cadena.

Para encontrar los identificadores de cadena que soportamos puede consultar la secci贸n de recursos. Puede encontrar la **informaci贸n sobre la cadena TESTNET** [aqu铆](/resources/testnet) y la **informaci贸n sobre la cadena MAINET** [aqu铆](/resources/mainnet).

### 2. Instala el SDK AxelarJs

AxelarJS SDK es una dependencia de `npm` que ayuda a realizar peticiones a la red Axelar. El SDK es esencialmente una envoltura alrededor de varios puntos finales de la API. Uno de los puntos finales le permite generar una direcci贸n de dep贸sito. Alternativamente, puede crear una direcci贸n de dep贸sito utilizando el [CLI en lugar del SDK](../../learn/cli).

```bash
npm i @axelar-network/axelarjs-sdk
# or
yarn add @axelar-network/axelarjs-sdk
```

### 3. Importa e inicializa el `AxelarAssetTransfer`

```ts
import { AxelarAssetTransfer, Environment } from "@axelar-network/axelarjs-sdk";

const axelarAssetTransfer = new AxelarAssetTransfer({
  environment: Environment.TESTNET,
});
```

### 4. Obtenga una estimaci贸n de los fees de la transferecia (opcional)

Si tiene previsto utilizar la funci贸n de transferencia de activos, es fundamental que tenga en cuenta los "relayer fees". Cualquier dep贸sito en una direcci贸n de dep贸sito que no supere este fee calculado no ser谩 procesado hasta que esa direcci贸n de dep贸sito sea recargada para cubrir el fee.

La siguiente consulta recupera el fee que cobra el repetidor por una transferencia.

```ts
import {
  AxelarQueryAPI,
  CHAINS,
  Environment,
} from "@axelar-network/axelarjs-sdk";

async function main() {
  const axelarQuery = new AxelarQueryAPI({
    environment: Environment.TESTNET,
  });

  const fee = await axelarQuery.getTransferFee(
    CHAINS.TESTNET.OSMOSIS,
    CHAINS.TESTNET.AVALANCHE,
    "uausdc",
    1000000
  );
  // returns  { fee: { denom: 'uausdc', amount: '150000' } }
}

main();
```

Puede consultar las denominaciones de los activos en nuestra [pagina de recursos](/resources/mainnet#assets).

### 5. Generar una direcci贸n de dep贸sito

> Cuando realice el dep贸sito, aseg煤rese de que el importe es superior al "cross-chain relayer gas fee". Puede calcular el fee con la funci贸n `getTransferFee`

La clase `AxelarAssetTransfer` expone la funci贸n `getDepositAddress`. Con esta funci贸n, puede crear una **direcci贸n de dep贸sito**. Aqu铆 est谩 la firma de la funci贸n 

```tsx
interface GetDepositAddressParams {
  fromChain: string; // Ver la nota (3)
  toChain: string; // Ver la nota (3)
  destinationAddress: string; // Ver la nota (1)
  asset: string; // denominaci贸n del activo. Ver la nota (2)
  options?: {
    shouldUnwrapIntoNative?: boolean;
    refundAddress?: string; // octional. Ver la nota (4)
  };
}

async getDepositAddress({
  fromChain, toChain, destinationAddress, asset
}: GetDepositAddressParams): Promise<string> {}
```

#### EJEMPLOS
Todos los posibles casos de uso est谩n cubiertos en los siguientes escenarios

##### 1. Enviar tokens desde una cadena basada en Cosmos

Transfiere cualquier activo soportado por Axelar desde una cadena basada en cosmos a una cadena de destino.
* Las cadenas de destino pueden ser una cadena EVM o una cadena basada en Cosmos.
* Al enviar a una cadena EVM, el activo llegar谩 como un activo ERC-20.

Ejemplo de criterios de aceptaci贸n:
`Quiero enviar axlUSDC en Osmosis y recibir la versi贸n ERC-20 equivalente en Avalanche.`

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.OSMOSIS,
  toChain = CHAINS.TESTNET.AVALANCHE,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "uausdc";  // denominaci贸n del activo. Ver la nota (2)

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset
});
```

##### 2. Enviar tokens ERC-20 desde una cadena EVM

Transfiera cualquier activo ERC-20 soportado por Axelar desde una cadena EVM a cualquier cadena de destino.
* Las cadenas de destino pueden ser una cadena EVM o una cadena basada en Cosmos.
* Cuando se env铆e a una cadena EVM, el activo llegar谩 como un activo ERC-20

Ejemplo de criterios de aceptaci贸n:
Quiero enviar axlUSDC en Avalanche y recibir axlUSDC en Osmosis.

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.AVALANCHE,
  toChain = CHAINS.TESTNET.OSMOSIS,
  destinationAddress = "osmo1x3z2vepjd7fhe30epncxjrk0lehq7xdqe8ltsn",
  asset = "uausdc";

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset
});

```

##### 3. Enviar tokens nativos de una cadena EVM

Tambi茅n conocido como 芦wrap禄, transfiere el activo nativo de una cadena EVM a cualquier cadena de destino.
* Las cadenas de destino pueden ser una cadena EVM o una cadena basada en cosmos
* Cuando se env铆a a una cadena EVM, el activo llegar谩 como un activo ERC-20 芦envuelto禄.
* La 煤nica diferencia con el caso (1) anterior es que el activo especificado es el activo nativo de la cadena EVM de origen.

Ejemplo de criterios de aceptaci贸n:
`Quiero enviar AVAX en Avalanche y recibir la versi贸n ERC-20 equivalente en Polygon.`

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.AVALANCHE,
  toChain = CHAINS.TESTNET.POLYGON,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "avax"

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset
});
```

##### 4. Enviar un token nativo envuelto desde una cadena EVM de vuelta a su cadena EVM de origen, por ejemplo, 芦UNWRAP禄.

Tambi茅n conocido como 芦wrap禄, transfiere un token nativo envuelto desde una cadena EVM de vuelta a su cadena EVM de origen
* La cadena de destino debe ser la cadena nativa del activo nativo empaquetado.
* Puede especificar un par谩metro opcional en las configuraciones para `GetDepositAddressParams` si desea recibir el activo en forma de tokens nativos en la cadena de destino O su equivalente ERC-20.

Dos escenarios a continuaci贸n

Ejemplo de criterios de aceptaci贸n:
Quiero enviar WAVAX en Polygon y recibir WAVAX en Avalanche.

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.POLYGON,
  toChain = CHAINS.TESTNET.AVALANCHE,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "wavax-wei"

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset,
  options: {
    shouldUnwrapIntoNative: false
  }
});
```

Ejemplo de criterios de aceptaci贸n:
`Quiero enviar WAVAX en Polygon y recibir AVAX en Avalanche.`

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.POLYGON,
  toChain = CHAINS.TESTNET.AVALANCHE,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "wavax-wei"

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset,
  options: {
    shouldUnwrapIntoNative: true
  }
});
```

##### Notas

(1) El formato de la direcci贸n de destino se valida en funci贸n de la cadena de destino. Aseg煤rese de que la direcci贸n de destino es una direcci贸n v谩lida en la cadena de destino. Por ejemplo, las direcciones Kujira empiezan por 芦kujira禄, etc.

Una vez generada la direcci贸n de dep贸sito, el usuario puede realizar una transferencia de tokens (en blockchain) a la direcci贸n de dep贸sito. La transferencia ser谩 recogida por la red Axelar y retransmitida a la cadena de destino.

(2) Para todos los activos que Axelar soporta de forma nativa, la red identifica el activo mediante un `denom`. Si est谩 acostumbrado al `symbol` t铆picamente utilizado en las cadenas EVM, tendr谩 que convertir ese `symbol` a un `denom`. El SDK tiene un m茅todo API que puede utilizar para convertir el s铆mbolo a denom: [getDenomFromSymbol](./axelar-query-api#getdenomfromsymbol)

(3) Los IDs de cadena (tal y como los reconoce Axelar) deben utilizarse aqu铆. Por ejemplo, en testnet, el ID de cadena para `Osmosis` es `osmosis-5`.


(4) La direcci贸n de devoluci贸n es un par谩metro opcional. Especifica la direcci贸n en una cadena de origen donde los tokens depositados err贸neamente en una direcci贸n de dep贸sito pueden ser reembolsados. Por ejemplo, si se gener贸 una direcci贸n de dep贸sito para enviar USDC, pero el usuario deposita por error WAVAX. Si no se especifica ninguna direcci贸n, la API asigna por defecto el par谩metro al contrato receptor de gas que puede reembolsar en nombre del usuario. Por el momento, el par谩metro refundAddress s贸lo es compatible con los casos de uso 3 y 4 anteriores, casos de envolver y desenvolver, respectivamente.
