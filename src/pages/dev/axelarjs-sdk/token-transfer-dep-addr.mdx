# Obtener una dirección de depósito

import { Callout } from "/src/components/callout"

Una dirección de depósito es una dirección especial temporal creada y supervisada por **Axelar's Relayer Services** en nombre del solicitante. Es similar a la forma en que las bolsas centralizadas generan una dirección de depósito única y supervisada que facilita las transferencias de tokens. Las direcciones de depósito suelen funcionar durante un máximo de 24 horas.

### Flujo de trabajo de la dirección de depósito

1. El usuario genera una dirección de depósito en una cadena de origen específica.
2. 2. El usuario envía tokens a la dirección de depósito de la cadena de origen.

- Ejemplos:

  - retirada de un exchange centralizado
  - transacción desde su wallet favorito.

<Callout emoji="ℹ️">
 NOTA IMPORTANTE: Al realizar su deposito, asegúrese de que el importe es     **mayor que la tasa de gas fee del relay cross-chain**
- Aquí encontrará una tabla de tasas:
[mainnet](../../resources/mainnet#cross-chain-relayer-gas-fee) | [testnet](../../resources/testnet#cross-chain-relayer-gas-fee).
- También se pueden consultar mediante programación en el SDK [AxelarQueryAPI](../axelarjs-sdk/axelar-query-api#gettransferfee).
</Callout>

3. Los relays de Axelar observan la transacción de depósito en la cadena de origen y la completan en la cadena de destino, suponiendo que el importe supere la tasa requerida..
4. Observa cómo llegan tus tokens a la cadena de destino.

### 1. Prerequisite

Para ayudarte a escribir código limpio, puedes utilizar las constantes `Environment` y `CHAINS`.

La mayoría de los métodos en el sdk requieren que trabajes con identificadores de cadena en lugar de nombres de cadena. **Los identificadores de cadena son únicos por entorno** y son _específicos de Axelar_. Por ejemplo, Ethereum tendrá un id de cadena `ethereum` en mainnet pero `ethereum-2` en testnet. Del mismo modo, Osmosis será `osmosis` en mainnet pero `osmosis-4` en tesnet. Sin embargo, algunas cadenas no tendrán ninguna diferencia entre los nombres de cadena y los identificadores de cadena.

Para encontrar los identificadores de cadena que soportamos puede consultar la sección de recursos. Puede encontrar la **información sobre la cadena TESTNET** [aquí](/resources/testnet) y la **información sobre la cadena MAINET** [aquí](/resources/mainnet).

### 2. Instala el SDK AxelarJs

AxelarJS SDK es una dependencia de `npm` que ayuda a realizar peticiones a la red Axelar. El SDK es esencialmente una envoltura alrededor de varios puntos finales de la API. Uno de los puntos finales le permite generar una dirección de depósito. Alternativamente, puede crear una dirección de depósito utilizando el [CLI en lugar del SDK](../../learn/cli).

```bash
npm i @axelar-network/axelarjs-sdk
# or
yarn add @axelar-network/axelarjs-sdk
```

### 3. Importa e inicializa el `AxelarAssetTransfer`

```ts
import { AxelarAssetTransfer, Environment } from "@axelar-network/axelarjs-sdk";

const axelarAssetTransfer = new AxelarAssetTransfer({
  environment: Environment.TESTNET,
});
```

### 4. Obtenga una estimación de los fees de la transferecia (opcional)

Si tiene previsto utilizar la función de transferencia de activos, es fundamental que tenga en cuenta los "relayer fees". Cualquier depósito en una dirección de depósito que no supere este fee calculado no será procesado hasta que esa dirección de depósito sea recargada para cubrir el fee.

La siguiente consulta recupera el fee que cobra el repetidor por una transferencia.

```ts
import {
  AxelarQueryAPI,
  CHAINS,
  Environment,
} from "@axelar-network/axelarjs-sdk";

async function main() {
  const axelarQuery = new AxelarQueryAPI({
    environment: Environment.TESTNET,
  });

  const fee = await axelarQuery.getTransferFee(
    CHAINS.TESTNET.OSMOSIS,
    CHAINS.TESTNET.AVALANCHE,
    "uausdc",
    1000000
  );
  // returns  { fee: { denom: 'uausdc', amount: '150000' } }
}

main();
```

Puede consultar las denominaciones de los activos en nuestra [pagina de recursos](/resources/mainnet#assets).

### 5. Generar una dirección de depósito

> Cuando realice el depósito, asegúrese de que el importe es superior al "cross-chain relayer gas fee". Puede calcular el fee con la función `getTransferFee`

La clase `AxelarAssetTransfer` expone la función `getDepositAddress`. Con esta función, puede crear una **dirección de depósito**. Aquí está la firma de la función 👇

```tsx
interface GetDepositAddressParams {
  fromChain: string; // Ver la nota (3)
  toChain: string; // Ver la nota (3)
  destinationAddress: string; // Ver la nota (1)
  asset: string; // denominación del activo. Ver la nota (2)
  options?: {
    shouldUnwrapIntoNative?: boolean;
    refundAddress?: string; // octional. Ver la nota (4)
  };
}

async getDepositAddress({
  fromChain, toChain, destinationAddress, asset
}: GetDepositAddressParams): Promise<string> {}
```

#### EJEMPLOS
Todos los posibles casos de uso están cubiertos en los siguientes escenarios

##### 1. Enviar tokens desde una cadena basada en Cosmos

Transfiere cualquier activo soportado por Axelar desde una cadena basada en cosmos a una cadena de destino.
* Las cadenas de destino pueden ser una cadena EVM o una cadena basada en Cosmos.
* Al enviar a una cadena EVM, el activo llegará como un activo ERC-20.

Ejemplo de criterios de aceptación:
`Quiero enviar axlUSDC en Osmosis y recibir la versión ERC-20 equivalente en Avalanche.`

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.OSMOSIS,
  toChain = CHAINS.TESTNET.AVALANCHE,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "uausdc";  // denominación del activo. Ver la nota (2)

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset
});
```

##### 2. Enviar tokens ERC-20 desde una cadena EVM

Transfiera cualquier activo ERC-20 soportado por Axelar desde una cadena EVM a cualquier cadena de destino.
* Las cadenas de destino pueden ser una cadena EVM o una cadena basada en Cosmos.
* Cuando se envíe a una cadena EVM, el activo llegará como un activo ERC-20

Ejemplo de criterios de aceptación:
Quiero enviar axlUSDC en Avalanche y recibir axlUSDC en Osmosis.

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.AVALANCHE,
  toChain = CHAINS.TESTNET.OSMOSIS,
  destinationAddress = "osmo1x3z2vepjd7fhe30epncxjrk0lehq7xdqe8ltsn",
  asset = "uausdc";

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset
});

```

##### 3. Enviar tokens nativos de una cadena EVM

También conocido como «wrap», transfiere el activo nativo de una cadena EVM a cualquier cadena de destino.
* Las cadenas de destino pueden ser una cadena EVM o una cadena basada en cosmos
* Cuando se envía a una cadena EVM, el activo llegará como un activo ERC-20 «envuelto».
* La única diferencia con el caso (1) anterior es que el activo especificado es el activo nativo de la cadena EVM de origen.

Ejemplo de criterios de aceptación:
`Quiero enviar AVAX en Avalanche y recibir la versión ERC-20 equivalente en Polygon.`

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.AVALANCHE,
  toChain = CHAINS.TESTNET.POLYGON,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "avax"

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset
});
```

##### 4. Enviar un token nativo envuelto desde una cadena EVM de vuelta a su cadena EVM de origen, por ejemplo, «UNWRAP».

También conocido como «wrap», transfiere un token nativo envuelto desde una cadena EVM de vuelta a su cadena EVM de origen
* La cadena de destino debe ser la cadena nativa del activo nativo empaquetado.
* Puede especificar un parámetro opcional en las configuraciones para `GetDepositAddressParams` si desea recibir el activo en forma de tokens nativos en la cadena de destino O su equivalente ERC-20.

Dos escenarios a continuación

Ejemplo de criterios de aceptación:
Quiero enviar WAVAX en Polygon y recibir WAVAX en Avalanche.

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.POLYGON,
  toChain = CHAINS.TESTNET.AVALANCHE,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "wavax-wei"

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset,
  options: {
    shouldUnwrapIntoNative: false
  }
});
```

Ejemplo de criterios de aceptación:
`Quiero enviar WAVAX en Polygon y recibir AVAX en Avalanche.`

```ts
const sdk = new AxelarAssetTransfer({ environment: "testnet" });

const fromChain = CHAINS.TESTNET.POLYGON,
  toChain = CHAINS.TESTNET.AVALANCHE,
  destinationAddress = "0xF16DfB26e1FEc993E085092563ECFAEaDa7eD7fD",
  asset = "wavax-wei"

const depositAddress = await sdk.getDepositAddress({
  fromChain,
  toChain,
  destinationAddress,
  asset,
  options: {
    shouldUnwrapIntoNative: true
  }
});
```

##### Notas

(1) El formato de la dirección de destino se valida en función de la cadena de destino. Asegúrese de que la dirección de destino es una dirección válida en la cadena de destino. Por ejemplo, las direcciones Kujira empiezan por «kujira», etc.

Una vez generada la dirección de depósito, el usuario puede realizar una transferencia de tokens (en blockchain) a la dirección de depósito. La transferencia será recogida por la red Axelar y retransmitida a la cadena de destino.

(2) Para todos los activos que Axelar soporta de forma nativa, la red identifica el activo mediante un `denom`. Si está acostumbrado al `symbol` típicamente utilizado en las cadenas EVM, tendrá que convertir ese `symbol` a un `denom`. El SDK tiene un método API que puede utilizar para convertir el símbolo a denom: [getDenomFromSymbol](./axelar-query-api#getdenomfromsymbol)

(3) Los IDs de cadena (tal y como los reconoce Axelar) deben utilizarse aquí. Por ejemplo, en testnet, el ID de cadena para `Osmosis` es `osmosis-5`.


(4) La dirección de devolución es un parámetro opcional. Especifica la dirección en una cadena de origen donde los tokens depositados erróneamente en una dirección de depósito pueden ser reembolsados. Por ejemplo, si se generó una dirección de depósito para enviar USDC, pero el usuario deposita por error WAVAX. Si no se especifica ninguna dirección, la API asigna por defecto el parámetro al contrato receptor de gas que puede reembolsar en nombre del usuario. Por el momento, el parámetro refundAddress sólo es compatible con los casos de uso 3 y 4 anteriores, casos de envolver y desenvolver, respectivamente.
